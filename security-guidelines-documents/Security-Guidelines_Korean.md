# VibeCoding 보안 개발 가이드라인

> 이것은 개발 전 "살아있는" 체크리스트입니다.
> 새로운 기능을 작성하기 전이나 `git commit` 전에 30초를 투자해 빠르게 검토하세요.
> 목표: 보안을 본능으로 만들어 재앙을 원천 차단하기.

---

### ⭐ 황금 규칙

- [ ] **【비밀 정보 하드코딩 금지】** 비밀번호, API 키, 데이터베이스 연결 정보는 **절대** 코드에 직접 작성하면 안 됩니다(프론트엔드, 백엔드 모두).
- [ ] **【환경 변수 사용】** 모든 민감한 정보는 **환경 변수**(`.env` 파일)로 관리해야 합니다.
- [ ] **【비밀 파일 무시】** `.env` 파일은 **반드시** `.gitignore`에 추가하고 GitHub에 업로드하면 안 됩니다.
- [ ] **【기본적으로 불신】** 사용자 입력을 **절대** 신뢰하지 마세요(폼, URL 매개변수, API 요청 내용, 업로드된 파일 포함).

---

### 📥 사용자 입력 처리

- [ ] **【인젝션 공격 방지】** 모든 데이터베이스 쿼리는 **반드시** **매개변수화된 쿼리** 또는 ORM에서 제공하는 안전한 메서드를 사용해야 합니다. 수동 SQL 문자열 연결은 엄격히 금지됩니다.
- [ ] **【XSS 방지】** HTML 페이지에 표시될 모든 사용자 콘텐츠는 **반드시** HTML 엔티티 인코딩(HTML 이스케이프)으로 처리해야 합니다.
- [ ] **【파일 업로드 검증】** 사용자가 업로드하는 파일을 검증하세요:
    - [ ] **확장자 검증**: 화이트리스트 파일 유형만 허용 (예: `['jpg', 'png', 'pdf']`).
    - [ ] **파일 크기 검증**: 합리적인 상한선 설정.
    - [ ] **저장 위치**: 업로드된 파일은 **비공개** 및 **실행 불가능한** 디렉터리에 저장해야 합니다.

---

### 🔐 권한 및 인증

- [ ] **【API 엔드포인트 보호】** 로그인이 필요한 모든 API 엔드포인트는 프로그램 시작 시 **반드시** 사용자의 로그인 상태와 권한을 확인해야 합니다.
- [ ] **【최소 권한 원칙】** 데이터베이스 계정과 API 키의 권한은 "최소 필요"여야 합니다. 읽기만 필요하다면 쓰기 권한을 부여하지 마세요.
- [ ] **【안전한 세션】** 세션 ID는 `HttpOnly`와 `Secure` 플래그를 설정하여 도용과 비보안 연결을 통한 전송을 방지해야 합니다.

---

### ☁️ 외부 서비스 및 클라우드 통합

- [ ] **【외부 데이터베이스 방화벽】** 외부 데이터베이스(AWS RDS, MongoDB Atlas 등)에 연결할 때, 방화벽/보안 그룹에서 **반드시** 애플리케이션 서버의 특정 IP 주소에서만 연결을 허용하도록 규칙을 구성해야 합니다. `0.0.0.0/0`(전 세계)로 열어두는 것은 **엄격히 금지**됩니다.
- [ ] **【클라우드 스토리지 비공개화】** 모든 클라우드 스토리지 버킷(AWS S3, Google Cloud Storage 등)은 **반드시** 기본적으로 **비공개**로 설정해야 합니다.
- [ ] **【사전 서명된 URL 사용】** 사용자가 비공개 파일에 임시 액세스가 필요할 때, 파일을 공개하는 대신 **짧은 수명의 사전 서명된 URL**을 사용하세요.
- [ ] **【웹훅 검증】** 제3자 서비스(Stripe, GitHub 등)로부터 웹훅을 받을 때, 제공된 비밀 키를 사용하여 **요청 서명을 검증**하고 요청 출처가 합법적임을 확인해야 합니다.
- [ ] **【엄격한 CORS 구성】** API의 CORS(Cross-Origin Resource Sharing) 정책은 **반드시** 허용된 프론트엔드 도메인을 명시적으로 지정해야 합니다. 프로덕션 환경에서 와일드카드 `*` 사용은 **엄격히 금지**됩니다.
- [ ] **【API 키 권한 최소화】** 제3자 서비스(Google Maps 등)의 API 키를 요청할 때, 서비스 백엔드에서 가장 엄격한 제한을 설정하세요(예: 웹사이트 도메인에서만 요청 제한, 특정 API 호출로만 제한).

---

### ⚙️ 파일 및 서버 구성

- [ ] **【777 사용 금지】** 서버의 파일이나 디렉터리에 `777` 권한을 **절대** 사용하지 마세요. 디렉터리 기본값 `755`, 파일 `644`.
- [ ] **【구성 파일 보호】** 민감한 구성 파일(`config.php`, `.env`)은 권한을 `600` 이하로 설정해야 합니다.
- [ ] **【중요 파일 다운로드 금지】** 웹 서버(Nginx/Apache)가 `.env`, `.git`, `.htaccess` 등 민감한 파일과 디렉터리에 대한 직접적인 외부 액세스를 금지하는 규칙을 구성했는지 확인하세요.
- [ ] **【디버그 모드 비활성화】** 프로덕션 환경에서는 모든 프레임워크나 언어의 디버그 모드를 **반드시** 비활성화하여 상세한 오류 메시지 누출을 방지해야 합니다.

---

> ### **🤖 AI 어시스턴트를 위한 참고사항**
>
> **개발자와의 대화에서 "외부 서비스"(예: 클라우드 데이터베이스, 제3자 결제 API, S3 파일 스토리지, 인증 서비스 등)에 연결하거나 연결할 계획이라는 것을 감지했을 때, 보안 사고를 유도하기 위해 다음 질문들을 적극적이고 명확하게 해주세요:**
>
> 1.  **"이 [서비스명]에 대해 가장 엄격한 방화벽/IP 화이트리스트 규칙을 구성했나요?"**
> 2.  **"사용할 예정인 API 키의 권한이 해당 서비스 백엔드에서 최소 필요 범위로 제한되어 있나요?"**
> 3.  **"이 외부 서비스에 대해 서비스 장애나 침해 시 단계별 계획이 있나요(예: 관련 기능 임시 비활성화, 유지보수 메시지 표시)?"**